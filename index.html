<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Nutritous Recipes</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <link rel="stylesheet" href="style.css">

</head>

<body>
  <nav>
    <div class="white-text nav-wrapper">
      <a href="#" class="brand-logo">Recipe Generator</a>
      <ul id="nav-mobile" class="right hide-on-med-and-down">
        <li><a href="#">Home</a></li>
        <li><a href="#">World Recipes</a></li>
        <li><a href="#">Advanced</a></li>
        <li><a href="#">Saved</a></li>
      </ul>
    </div>
  </nav>

<div class="hero">
  <div class="container" id="searchStyle">
    <div class="row">
      <form class="col s12">
        <div class="row">
          <p id="indexTitle">Search For a Recipe!</p>
          <div class="input-field col s10">
            <input id="icon_prefix" type="text" class="validate">
            <label for="icon_prefix">Recipes</label>
          </div>
          <div class="input-field col s2">
            <a class="waves-effect waves-light btn searchBtn">Search</a>
          </div>
        </div>
      </form>
    </div>
  </div>

  <div class="container" id="resultStyle">
    <div class="row">
      <div id="note">Click to Uncollapse</div>
      <ul id="recipe-container" class="collapsible expandable"></ul>
    </div>
  </div>
</div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <script>

    //Materilize function for collapsible
    $(document).ready(function () {
      $('.collapsible').collapsible();
    });

    $(".searchBtn").on("click",searchCriteria)

    function searchCriteria() {
      //foodSearchQuery
      var ingredients = []
      var num = "1"
      var food = $(".validate").val()
      var applicationID = "6c4c5067"
      var appKey = "56dd4a4b1dc04c1107300036e876fbf8"
      var queryURL = "https://api.edamam.com/search?q=" + food + "&app_id=" + applicationID + "&app_key=" + appKey + "&to=" + num

      $.ajax({
      url: queryURL,
      method: "GET"
    }).then(function (response) {

      var numberofRecipes = 1

      for (var i = 0; i < numberofRecipes; i++) {
        //Save recipe title, image, and ingredients array to variables
        var foodTitle = response.hits[i].recipe.label
        var foodImage = response.hits[i].recipe.image
        var ingredients = response.hits[i].recipe.ingredientLines
        var prep = response.hits[i].recipe.url

        //select container element
        var container = $("#recipe-container");
        //create and append new list item
        var newRecipe = $("<li>");
        container.append(newRecipe);
        newRecipe.addClass("active")

        //create and append header div
        var header = $("<div>");
        newRecipe.append(header);
        header.addClass("collapsible-header");
        header.text(foodTitle)

        //create and append body div
        var body = $("<div>");
        newRecipe.append(body);
        body.addClass("collapsible-body");
        body.attr("style", "display: block;")

        //Create and append organizing grid containers
        var row = $("<div>");
        var left = $("<div>");
        var middle = $("<div>");
        var right = $("<div>");
        row.addClass("row");
        left.addClass("col s4");
        right.addClass("col s8");
        body.append(row);
        row.append(left);
        row.append(right);

        //Create and append image using recipe image
        var image = $("<img>");
        image.attr("src", foodImage);
        left.append(image);

        //Create and append "Ingredients" title
        var ingredientTitle = $("<h5>");
        ingredientTitle.text("Ingredients:");
        right.append(ingredientTitle);

        //Create and append a list container inside body
        var ingredientList = $("<ul>");
        right.append(ingredientList);

        //loop through ingredients array and add list items for each
        for (j = 0; j < ingredients.length; j++) {
          var newItem = $("<li>");
          ingredientList.append(newItem);
          newItem.text(ingredients[j])
        }

        //Create and append link to preperation instructions
        var prepTitle = $("<h5>");
        right.append(prepTitle);

        var prepLink = $("<a>");
        prepLink.text("Preparation");
        prepLink.attr("href", prep);
        prepLink.addClass("waves-effect waves-light btn");
        prepTitle.append(prepLink);

        //Save Button
        var saveButton = $("<button>")
        saveButton.text("Save")
        saveButton.attr("class", "waves-effect waves-light btn save")
        right.append(saveButton)

      }

    });
    }

    


  </script>
</body>

</html>