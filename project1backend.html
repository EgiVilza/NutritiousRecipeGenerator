<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<html>

<body>
  
<!-- Buttons -->
  <label for="foodSearch">Food Search:</label>
  <input type="text" id="foodSearch" name="foodSearch">

  <br><br>
  
  <div id = healthLabelButtonContainer>
  </div>


  <br></br>

  <button type="button" onclick="recipeQuery()"id="searchButton">Search!</button>
  <button type="button" onclick="recipeRandomQuery()"id="searchRandomButton">Random!</button>
  <button type="button" onclick="recipeTimeRandomQuery()"id="searchRandomTimeButton">Random Based on Hour!</button>

  <div id = results>
  </div>

</body>


</html>


<script>

//All possible labels, available to users that pay for a license
//var healthLabelsArray = ["vegan", "vegetarian", "paleo", "dairy-free", "gluten-free", "wheat-free", "fat-free", "low-sugar", "egg-free", "peanut-free", "tree-nut-free", "soy-free", "fish-free", "shellfish-free"]
//All labels that appear to work 
var healthLabelsArray = ["vegan", "vegetarian", "peanut-free", "tree-nut-free","alcohol-free"]
function generateCheckboxes(array){
var checkboxes = ""
for (j=0;j<array.length;j++){
checkboxes += '<input type="checkbox" class="restrictionBox" id="'
checkboxes += array[j]
checkboxes += '" name="'
checkboxes += array[j]
checkboxes += '" value="'
checkboxes += array[j]
checkboxes += '"><label for="'
checkboxes += "health" + j
checkboxes += '">'
checkboxes += array[j]
checkboxes += '</label><br>'
}
$('#healthLabelButtonContainer').append(checkboxes)
}

// generates Checkboxes when page opened
generateCheckboxes(healthLabelsArray)

//Checks if any boxes are checked, returns true if so, false if not
function anyRestrictions (){
  if($(".restrictionBox").is(':checked')){
   return true
  }
    else{
   return false
  }
}
//Returns an array of every checked checkbox's value
function allChecked (){
    var allChecked = $('.restrictionBox:checkbox:checked')
    var allCheckedArray = []
  for (i=0; i<allChecked.length; i++){
  allCheckedArray.push(allChecked[i].value)
  }
  return allCheckedArray
}

//Transforms an array into one that is appropriate for the API in checking health restrictions
function generateHealthString(array){
  var healthString = ""
  for (i=0; i<array.length; i++){
  healthString = healthString + "&health=" + array[i]
  }
  return healthString  
}

// Function that queries the API
function recipeQuery(){  
//Grabs user input for search
var foodSearch = $("#foodSearch").val()

//Generates a string of health restrictions to be appeneded at the end of the query by passing allChecked() into generateHealthString
var finalHealthString = ""
var finalHealthString = generateHealthString(allChecked())

//appID and key
var appID = "349b98ef"
var key = "5e98e5359fcce19875540fb80e3daf8a"
var queryURL = "https://api.edamam.com/search?q=" + foodSearch + "&app_id=" + appID + "&app_key=" + key + finalHealthString
   
//Queries the API and console logs the response
      $.ajax({
        url: queryURL,
        method: "GET"
      })

      .then(function(response) {
          console.log(queryURL)
          console.log(response)
      })
}

//Generates a random integer from 0 up to the value of randomMax.
function randomUpTo(randomMax) {
  return ((Math.floor(Math.random() * (randomMax + 1))))
}

function recipeRandomQuery(){  
//Grabs user input for search
var foodSearch = $("#foodSearch").val()

//Generates a string of health restrictions to be appeneded at the end of the query by passing allChecked() into generateHealthString
var finalHealthString = ""
var finalHealthString = generateHealthString(allChecked())

//appID and key
var appID = "349b98ef"
var key = "5e98e5359fcce19875540fb80e3daf8a"
var queryURL = "https://api.edamam.com/search?q=" + foodSearch + "&app_id=" + appID + "&app_key=" + key + finalHealthString
   
//Queries the API and console logs the response
      $.ajax({
        url: queryURL,
        method: "GET"
      })

      .then(function(response) {
          console.log(queryURL)
          console.log(response.hits[randomUpTo(9)].recipe)
          //$('#results').append(response.hits[randomUpTo(9)].recipe)
      })
}

function recipeTimeRandomQuery(){  
//Grabs user input for search
if (new Date().getHours() < 11){
var foodSearch = "breakfast"}
else if (new Date().getHours() > 11 && new Date().getHours() < 16 ){
var foodSearch = "lunch"}
else{
var foodSearh = "dinner"
}
//Generates a string of health restrictions to be appeneded at the end of the query by passing allChecked() into generateHealthString
var finalHealthString = ""
var finalHealthString = generateHealthString(allChecked())

//appID and key
var appID = "349b98ef"
var key = "5e98e5359fcce19875540fb80e3daf8a"
var queryURL = "https://api.edamam.com/search?q=" + foodSearch + "&app_id=" + appID + "&app_key=" + key + finalHealthString
   
//Queries the API and console logs the response
      $.ajax({
        url: queryURL,
        method: "GET"
      })

      .then(function(response) {
          console.log(queryURL)
          console.log(response.hits[randomUpTo(9)].recipe)
          //$('#results').append(response.hits[randomUpTo(9)].recipe)
      })
}





//Makes the search button do searches (currently prints them to console)
//Nevermind this button doesn't work for some reason you have to type recipeQuery() into the console to send it

</script>
