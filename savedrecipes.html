<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Nutritous Recipes</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link rel="stylesheet" href="style.css">

</head>

<body>
    <nav>
        <div class="white-text nav-wrapper">
            <a href="#" class="brand-logo">Recipe Generator</a>
            <ul id="nav-mobile" class="right hide-on-med-and-down">
                <li><a href="#">Home</a></li>
                <li><a href="#">World Recipes</a></li>
                <li><a href="#">Advanced</a></li>
                <li><a href="#">Saved</a></li>
            </ul>
        </div>
    </nav>

    <div class="hero">
        <div class="container">
            <div class="row">
                <form class="col s12">
                    <div class="row">
                        <p id="indexTitle">View the recipes you've saved!</p>

                    </div>
                </form>
            </div>
        </div>

        <div class="container" id="resultStyle">
            <div class="row fullrow">
                <div class="container">
                <div id="note">Click to Uncollapse</div>
                <ul id="recipe-container" class="collapsible expandable"></ul>
            </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script type="text/javascript">
        var elem = document.querySelector('.collapsible.expandable');
        var instance = M.Collapsible.init(elem, {
            accordion: false
        });

        //Saves sample recipe to local storage for testing
        // var recipe = {
        //     foodTitle: "Cauliflower Veloute with American Caviar",
        //     foodImage: "https://www.edamam.com/web-img/2b1/2b130d86301a129ecef68bd9399870de.jpg",
        //     ingredients: ["2 tablespoons unsalted butter", "1 medium shallot, chopped", "2 large heads cauliflower, cut into 1-inch pieces (about 12 cups)", "2 cups heavy cream", "3 1/2 cups homemade or store-bought low-sodium chicken or vegetable stock", "2 tablespoons olive oil", "Coarse salt and freshly ground black pepper", "2 tablespoons freshly squeezed lemon juice", "1/4 teaspoon cayenne pepper", "2 ounces american caviar, such as paddlefish", "1 small bunch fresh tarragon, for garnish"],
        //     prep: "http://www.marthastewart.com/859170/cauliflower-veloute-american-caviar",
        // };

        // var savedRecipes = [recipe, recipe]
        // localStorage.setItem("savedRecipes", JSON.stringify(savedRecipes));

        //get stored recipe from local storage
        var savedRecipes = JSON.parse(localStorage.getItem("savedRecipes"));


        //save recipe title, image, and ingredients array to variables
        for (i = 0; i < savedRecipes.length; i++) {

            var foodTitle = savedRecipes[i].foodTitle
            var foodImage = savedRecipes[i].foodImage
            var ingredients = savedRecipes[i].ingredients
            var prep = savedRecipes[i].prep

            //select container element
            var container = $("#recipe-container");
            //create and append new list item
            var newRecipe = $("<li>");
            container.append(newRecipe);

            //create and append header div
            var header = $("<div>");
            newRecipe.append(header);
            header.addClass("collapsible-header");
            header.text(foodTitle)

            //create and append body div
            var body = $("<div>");
            newRecipe.append(body);
            body.addClass("collapsible-body");

            //Create and append organizing grid containers
            var row = $("<div>");
            var left = $("<div>");
            var middle = $("<div>");
            var right = $("<div>");
            row.addClass("row");
            left.addClass("col s4");
            right.addClass("col s8");
            body.append(row);
            row.append(left);
            row.append(right);

            //Create and append image using recipe image
            var image = $("<img>");
            image.attr("src", foodImage);
            image.addClass("responsive-img");
            left.append(image);

            //Create and append "Ingredients" title
            var ingredientTitle = $("<h5>");
            ingredientTitle.text("Ingredients:");
            right.append(ingredientTitle);

            //Create and append a list container inside body
            var ingredientList = $("<ul>");
            right.append(ingredientList);

            //loop through ingredients array and add list items for each
            for (j = 0; j < ingredients.length; j++) {
                var newItem = $("<li>");
                ingredientList.append(newItem);
                newItem.text(ingredients[j])
            }

            //Create and append button to link to preperation instructions
            var prepTitle = $("<h4>");
            right.append(prepTitle);

            var prepLink = $("<a>");
            prepLink.text("Preparation");
            prepLink.attr("href", prep);
            prepLink.addClass("waves-effect waves-light btn");
            prepTitle.append(prepLink);

            //Create and append button delete current recipe
            var deleteButton = $("<a>");
            deleteButton.text("Delete");
            deleteButton.data("id", i);
            deleteButton.addClass("waves-effect waves-light btn red right");
            prepTitle.append(deleteButton);
            var trashIcon = $("<i>");
            trashIcon.addClass("material-icons right");
            trashIcon.text("delete");
            deleteButton.append(trashIcon);


        }




    </script>
</body>

</html>